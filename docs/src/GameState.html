<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS -Wall #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">{-|
Module      : GameState
Description : Funkcje i typy danych dotycz&#261;ce stanu gry. 

Ten modu&#322; zawiera definicje typu stanu gry oraz funkcji z tym zwi&#261;zanych.
Zawiera r&#243;wnie&#380; funkcje odpowiadaj&#261;ce za zapis i odczyt stanu gry z pliku. 
-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GameState</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Error</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="RoomParser.html"><span class="hs-identifier">RoomParser</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">-- | Alias dla skr&#243;cenia zapisu. </span><span>
</span><span id="line-26"></span><span class="hs-keyword">type</span><span> </span><span id="GameIO"><span class="annot"><a href="GameState.html#GameIO"><span class="hs-identifier hs-var">GameIO</span></a></span></span><span> </span><span id="local-6989586621679123226"><span class="annot"><a href="#local-6989586621679123226"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-type">AdventureGame</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679123226"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-comment">-- | Typ reprezentuj&#261;cy stan gry</span><span>
</span><span id="line-29"></span><span id="local-6989586621679123224"><span id="local-6989586621679123225"></span></span><span class="hs-keyword">data</span><span> </span><span id="AdventureGame"><span class="annot"><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-var">AdventureGame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AdventureGame"><span class="annot"><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-var">AdventureGame</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-30"></span><span>   </span><span id="gameWorld"><span class="annot"><span class="annottext">AdventureGame -&gt; World
</span><a href="GameState.html#gameWorld"><span class="hs-identifier hs-var hs-var">gameWorld</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameState.html#World"><span class="hs-identifier hs-type">World</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ mapa zawieraj&#261;ce wszystkie pokoje, czyli &#347;wiat gry</span><span>
</span><span id="line-31"></span><span>   </span><span id="inventory"><span class="annot"><span class="annottext">AdventureGame -&gt; [ItemName]
</span><a href="GameState.html#inventory"><span class="hs-identifier hs-var hs-var">inventory</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="RoomParser.html#ItemName"><span class="hs-identifier hs-type">ItemName</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ lista zawieraj&#261;ca posiadane przedmioty</span><span>
</span><span id="line-32"></span><span>   </span><span id="currentRoomName"><span class="annot"><span class="annottext">AdventureGame -&gt; ItemName
</span><a href="GameState.html#currentRoomName"><span class="hs-identifier hs-var hs-var">currentRoomName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="RoomParser.html#RoomName"><span class="hs-identifier hs-type">RoomName</span></a></span><span> </span><span class="hs-comment">-- ^ nazwa pokoju w kt&#243;rym aktualnie znajduje si&#281; gracz</span><span>
</span><span id="line-33"></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. AdventureGame -&gt; Rep AdventureGame x)
-&gt; (forall x. Rep AdventureGame x -&gt; AdventureGame)
-&gt; Generic AdventureGame
forall x. Rep AdventureGame x -&gt; AdventureGame
forall x. AdventureGame -&gt; Rep AdventureGame x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep AdventureGame x -&gt; AdventureGame
$cfrom :: forall x. AdventureGame -&gt; Rep AdventureGame x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- | Alias dla mapy pokoj&#243;w, czyli &#347;wiata gry. </span><span>
</span><span id="line-36"></span><span class="hs-keyword">type</span><span> </span><span id="World"><span class="annot"><a href="GameState.html#World"><span class="hs-identifier hs-var">World</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="RoomParser.html#RoomName"><span class="hs-identifier hs-type">RoomName</span></a></span><span> </span><span class="annot"><a href="RoomParser.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | Domy&#347;lna implementacja ToJSON dla AdventureGame</span><span>
</span><span id="line-39"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679123208"><span id="local-6989586621679123210"><span id="local-6989586621679123212"><span id="local-6989586621679123214"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-type">AdventureGame</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | Domy&#347;lna implementacja FromJSON dla AdventureGame</span><span>
</span><span id="line-42"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679123203"><span id="local-6989586621679123205"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-type">AdventureGame</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | Funkcja koduje i zapisuje stan gry typu 'AdventureGame' do podanego pliku. </span><span>
</span><span id="line-45"></span><span class="hs-comment">-- Plik zostaje zapisany do folderu gameFiles. </span><span>
</span><span id="line-46"></span><span class="annot"><a href="GameState.html#saveStateToFile"><span class="hs-identifier hs-type">saveStateToFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-type">AdventureGame</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span id="saveStateToFile"><span class="annot"><span class="annottext">saveStateToFile :: FilePath -&gt; AdventureGame -&gt; IO ()
</span><a href="GameState.html#saveStateToFile"><span class="hs-identifier hs-var hs-var">saveStateToFile</span></a></span></span><span> </span><span id="local-6989586621679123200"><span class="annot"><span class="annottext">fileName :: FilePath
</span><a href="#local-6989586621679123200"><span class="hs-identifier hs-var">fileName</span></a></span></span><span> </span><span id="local-6989586621679123199"><span class="annot"><span class="annottext">game :: AdventureGame
</span><a href="#local-6989586621679123199"><span class="hs-identifier hs-var">game</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; AdventureGame -&gt; IO ()
forall a. ToJSON a =&gt; FilePath -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">encodeFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;gameFiles&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123200"><span class="hs-identifier hs-var">fileName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AdventureGame
</span><a href="#local-6989586621679123199"><span class="hs-identifier hs-var">game</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;State saved!&quot;</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | Funkcja odczytuje stan gry typu 'AdventureGame' z podanego pliku. </span><span>
</span><span id="line-50"></span><span class="hs-comment">-- Plik powinien si&#281; znajdowa&#263; w folderze gameFiles. </span><span>
</span><span id="line-51"></span><span class="annot"><a href="GameState.html#loadStateFromFile"><span class="hs-identifier hs-type">loadStateFromFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-type">AdventureGame</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span id="loadStateFromFile"><span class="annot"><span class="annottext">loadStateFromFile :: FilePath -&gt; IO (Either FilePath AdventureGame)
</span><a href="GameState.html#loadStateFromFile"><span class="hs-identifier hs-var hs-var">loadStateFromFile</span></a></span></span><span> </span><span id="local-6989586621679123193"><span class="annot"><span class="annottext">fileName :: FilePath
</span><a href="#local-6989586621679123193"><span class="hs-identifier hs-var">fileName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Either FilePath AdventureGame)
forall a. FromJSON a =&gt; FilePath -&gt; IO (Either FilePath a)
</span><span class="hs-identifier hs-var">eitherDecodeFileStrict</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO (Either FilePath AdventureGame))
-&gt; FilePath -&gt; IO (Either FilePath AdventureGame)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;gameFiles&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123193"><span class="hs-identifier hs-var">fileName</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | Funkcja pr&#243;buje za&#322;adowa&#263; stan gry z podanego pliku za pomoc&#261; funkcji 'loadStateFromFile'. </span><span>
</span><span id="line-55"></span><span class="hs-comment">-- Je&#347;li stan gry zostanie poprawnie sparsowany, jest on ustawiany jako aktualny. </span><span>
</span><span id="line-56"></span><span class="hs-comment">-- Wpp wypisywany jest b&#322;&#261;d. </span><span>
</span><span id="line-57"></span><span class="annot"><a href="GameState.html#loadState"><span class="hs-identifier hs-type">loadState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameState.html#GameIO"><span class="hs-identifier hs-type">GameIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span id="loadState"><span class="annot"><span class="annottext">loadState :: FilePath -&gt; GameIO ()
</span><a href="GameState.html#loadState"><span class="hs-identifier hs-var hs-var">loadState</span></a></span></span><span> </span><span id="local-6989586621679123190"><span class="annot"><span class="annottext">file :: FilePath
</span><a href="#local-6989586621679123190"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-59"></span><span>   </span><span id="local-6989586621679123189"><span class="annot"><span class="annottext">Either FilePath AdventureGame
</span><a href="#local-6989586621679123189"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either FilePath AdventureGame)
-&gt; StateT AdventureGame IO (Either FilePath AdventureGame)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either FilePath AdventureGame)
 -&gt; StateT AdventureGame IO (Either FilePath AdventureGame))
-&gt; IO (Either FilePath AdventureGame)
-&gt; StateT AdventureGame IO (Either FilePath AdventureGame)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Either FilePath AdventureGame)
</span><a href="GameState.html#loadStateFromFile"><span class="hs-identifier hs-var">loadStateFromFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123190"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-60"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either FilePath AdventureGame
</span><a href="#local-6989586621679123189"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><span id="line-61"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679123187"><span class="annot"><span class="annottext">game :: AdventureGame
</span><a href="#local-6989586621679123187"><span class="hs-identifier hs-var">game</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AdventureGame -&gt; GameIO ()
forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">AdventureGame
</span><a href="#local-6989586621679123187"><span class="hs-identifier hs-var">game</span></a></span><span> </span><span>
</span><span id="line-62"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679123185"><span class="annot"><span class="annottext">err :: FilePath
</span><a href="#local-6989586621679123185"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; GameIO ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123185"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | Funkcja zapisuje stan gry za pomoc&#261; funkcji 'saveStateToFile'. </span><span>
</span><span id="line-65"></span><span class="annot"><a href="GameState.html#saveState"><span class="hs-identifier hs-type">saveState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameState.html#GameIO"><span class="hs-identifier hs-type">GameIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span id="saveState"><span class="annot"><span class="annottext">saveState :: FilePath -&gt; GameIO ()
</span><a href="GameState.html#saveState"><span class="hs-identifier hs-var hs-var">saveState</span></a></span></span><span> </span><span id="local-6989586621679123183"><span class="annot"><span class="annottext">file :: FilePath
</span><a href="#local-6989586621679123183"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT AdventureGame IO AdventureGame
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><span class="hs-identifier hs-var">get</span></span><span> </span><span class="annot"><span class="annottext">StateT AdventureGame IO AdventureGame
-&gt; (AdventureGame -&gt; GameIO ()) -&gt; GameIO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; GameIO ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; GameIO ())
-&gt; (AdventureGame -&gt; IO ()) -&gt; AdventureGame -&gt; GameIO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; AdventureGame -&gt; IO ()
</span><a href="GameState.html#saveStateToFile"><span class="hs-identifier hs-var">saveStateToFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123183"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Funkcja zwracaj&#261;ca aktualny pok&#243;j. </span><span>
</span><span id="line-69"></span><span class="hs-comment">-- Je&#347;li pok&#243;j nie zostanie odnaleziony poprzez nazw&#281;, zwracany jest &quot;zgubiony pok&#243;j&quot;.</span><span>
</span><span id="line-70"></span><span class="annot"><a href="GameState.html#getCurrentRoom"><span class="hs-identifier hs-type">getCurrentRoom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-type">AdventureGame</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="RoomParser.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span>
</span><span id="line-71"></span><span id="getCurrentRoom"><span class="annot"><span class="annottext">getCurrentRoom :: AdventureGame -&gt; Room
</span><a href="GameState.html#getCurrentRoom"><span class="hs-identifier hs-var hs-var">getCurrentRoom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-type">AdventureGame</span></a></span><span> </span><span id="local-6989586621679123179"><span class="annot"><span class="annottext">world :: World
</span><a href="#local-6989586621679123179"><span class="hs-identifier hs-var">world</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679123178"><span class="annot"><span class="annottext">currentRoom :: ItemName
</span><a href="#local-6989586621679123178"><span class="hs-identifier hs-var">currentRoom</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Room -&gt; Maybe Room -&gt; Room
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Room
</span><a href="RoomParser.html#lostRoom"><span class="hs-identifier hs-var">lostRoom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ItemName -&gt; World -&gt; Maybe Room
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">ItemName
</span><a href="#local-6989586621679123178"><span class="hs-identifier hs-var">currentRoom</span></a></span><span> </span><span class="annot"><span class="annottext">World
</span><a href="#local-6989586621679123179"><span class="hs-identifier hs-var">world</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | Funkcja zwracaj&#261;ca aktualny pok&#243;j w monadzie Maybe. </span><span>
</span><span id="line-74"></span><span class="hs-comment">-- Je&#347;li pok&#243;j nie zostanie odnaleziony poprzez nazw&#281;, zwracane jest Nothing</span><span>
</span><span id="line-75"></span><span class="annot"><a href="GameState.html#getCurrentRoom%27"><span class="hs-identifier hs-type">getCurrentRoom'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-type">AdventureGame</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="RoomParser.html#Room"><span class="hs-identifier hs-type">Room</span></a></span><span>
</span><span id="line-76"></span><span id="getCurrentRoom%27"><span class="annot"><span class="annottext">getCurrentRoom' :: AdventureGame -&gt; Maybe Room
</span><a href="GameState.html#getCurrentRoom%27"><span class="hs-identifier hs-var hs-var">getCurrentRoom'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-type">AdventureGame</span></a></span><span> </span><span id="local-6989586621679123173"><span class="annot"><span class="annottext">world :: World
</span><a href="#local-6989586621679123173"><span class="hs-identifier hs-var">world</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679123172"><span class="annot"><span class="annottext">currentRoom :: ItemName
</span><a href="#local-6989586621679123172"><span class="hs-identifier hs-var">currentRoom</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ItemName -&gt; World -&gt; Maybe Room
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">ItemName
</span><a href="#local-6989586621679123172"><span class="hs-identifier hs-var">currentRoom</span></a></span><span> </span><span class="annot"><span class="annottext">World
</span><a href="#local-6989586621679123173"><span class="hs-identifier hs-var">world</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | Funkcja restartuje gr&#281; ustawiaj&#261;c nowy stan gry. </span><span>
</span><span id="line-79"></span><span class="annot"><a href="GameState.html#restartGame"><span class="hs-identifier hs-type">restartGame</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameState.html#GameIO"><span class="hs-identifier hs-type">GameIO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span>
</span><span id="line-80"></span><span id="restartGame"><span class="annot"><span class="annottext">restartGame :: GameIO Bool
</span><a href="GameState.html#restartGame"><span class="hs-identifier hs-var hs-var">restartGame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-81"></span><span>   </span><span id="local-6989586621679123170"><span class="annot"><span class="annottext">Either FilePath World
</span><a href="#local-6989586621679123170"><span class="hs-identifier hs-var">rooms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either FilePath World)
-&gt; StateT AdventureGame IO (Either FilePath World)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">IO (Either FilePath World)
</span><a href="RoomParser.html#parseGameRomms"><span class="hs-identifier hs-var">parseGameRomms</span></a></span><span>
</span><span id="line-82"></span><span>   </span><span id="local-6989586621679123168"><span class="annot"><span class="annottext">ItemName
</span><a href="#local-6989586621679123168"><span class="hs-identifier hs-var">startRoom</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ItemName -&gt; StateT AdventureGame IO ItemName
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">IO ItemName
</span><a href="RoomParser.html#parseStartRoom"><span class="hs-identifier hs-var">parseStartRoom</span></a></span><span>        </span><span>
</span><span id="line-83"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either FilePath World
</span><a href="#local-6989586621679123170"><span class="hs-identifier hs-var">rooms</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679123166"><span class="annot"><span class="annottext">err :: FilePath
</span><a href="#local-6989586621679123166"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; GameIO Bool
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; GameIO Bool) -&gt; IO Bool -&gt; GameIO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123166"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO Bool -&gt; IO Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679123165"><span class="annot"><span class="annottext">r :: World
</span><a href="#local-6989586621679123165"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AdventureGame -&gt; GameIO ()
forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">World -&gt; [ItemName] -&gt; ItemName -&gt; AdventureGame
</span><a href="GameState.html#AdventureGame"><span class="hs-identifier hs-var">AdventureGame</span></a></span><span> </span><span class="annot"><span class="annottext">World
</span><a href="#local-6989586621679123165"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ItemName
</span><a href="#local-6989586621679123168"><span class="hs-identifier hs-var">startRoom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GameIO () -&gt; GameIO () -&gt; GameIO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; GameIO ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Game restarted.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GameIO () -&gt; GameIO Bool -&gt; GameIO Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; GameIO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | Funkcja wy&#347;wietla zawarto&#347;&#263; podanego pliku znajduj&#261;cego si&#281; w folderze gameFiles. </span><span>
</span><span id="line-88"></span><span class="annot"><a href="GameState.html#showGameFile"><span class="hs-identifier hs-type">showGameFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span id="showGameFile"><span class="annot"><span class="annottext">showGameFile :: FilePath -&gt; IO ()
</span><a href="GameState.html#showGameFile"><span class="hs-identifier hs-var hs-var">showGameFile</span></a></span></span><span> </span><span id="local-6989586621679123163"><span class="annot"><span class="annottext">fileName :: FilePath
</span><a href="#local-6989586621679123163"><span class="hs-identifier hs-var">fileName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; (IOError -&gt; IO ()) -&gt; IO ()
forall a. IO a -&gt; (IOError -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">catchIOError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">readFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;gameFiles&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123163"><span class="hs-identifier hs-var">fileName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; (FilePath -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IOError -&gt; IO ()
</span><a href="#local-6989586621679123160"><span class="hs-identifier hs-var">catchErrFun</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>     </span><span id="local-6989586621679123160"><span class="annot"><span class="annottext">catchErrFun :: IOError -&gt; IO ()
</span><a href="#local-6989586621679123160"><span class="hs-identifier hs-var hs-var">catchErrFun</span></a></span></span><span> </span><span id="local-6989586621679123159"><span class="annot"><span class="annottext">err :: IOError
</span><a href="#local-6989586621679123159"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">IOError -&gt; Bool
</span><span class="hs-identifier hs-var">isDoesNotExistError</span></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679123159"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;This file is not defined :(&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IOError -&gt; IO ()
forall a. IOError -&gt; IO a
</span><span class="hs-identifier hs-var">ioError</span></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679123159"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Funkcja wy&#347;wietla plik zawieraj&#261;cy instrukcj&#281; pomocy dla gracza. </span><span>
</span><span id="line-94"></span><span class="hs-comment">-- Plik powinien si&#281; znajdowa&#263; w folderze gameFiles i mie&#263; nazw&#281; help.txt. </span><span>
</span><span id="line-95"></span><span class="annot"><a href="GameState.html#showHelp"><span class="hs-identifier hs-type">showHelp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameState.html#GameIO"><span class="hs-identifier hs-type">GameIO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span>
</span><span id="line-96"></span><span id="showHelp"><span class="annot"><span class="annottext">showHelp :: GameIO Bool
</span><a href="GameState.html#showHelp"><span class="hs-identifier hs-var hs-var">showHelp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; GameIO Bool
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; GameIO Bool) -&gt; IO Bool -&gt; GameIO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="GameState.html#showGameFile"><span class="hs-identifier hs-var">showGameFile</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;help.txt&quot;</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO Bool -&gt; IO Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Funkcja wy&#347;wietla plik zawieraj&#261;cy powitanie dla gracza. </span><span>
</span><span id="line-99"></span><span class="hs-comment">-- Plik powinien si&#281; znajdowa&#263; w folderze gameFiles i mie&#263; nazw&#281; welcome.txt. </span><span>
</span><span id="line-100"></span><span class="annot"><a href="GameState.html#showWelcome"><span class="hs-identifier hs-type">showWelcome</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span id="showWelcome"><span class="annot"><span class="annottext">showWelcome :: IO ()
</span><a href="GameState.html#showWelcome"><span class="hs-identifier hs-var hs-var">showWelcome</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="GameState.html#showGameFile"><span class="hs-identifier hs-var">showGameFile</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;welcome.txt&quot;</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | Funkcja wy&#347;wietla pok&#243;j o podanej nazwie.</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- Jest u&#380;ywana do wy&#347;wietlania opisu startowego pokoju. </span><span>
</span><span id="line-105"></span><span class="annot"><a href="GameState.html#showFirstRoom"><span class="hs-identifier hs-type">showFirstRoom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="RoomParser.html#RoomName"><span class="hs-identifier hs-type">RoomName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameState.html#World"><span class="hs-identifier hs-type">World</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span id="showFirstRoom"><span class="annot"><span class="annottext">showFirstRoom :: ItemName -&gt; World -&gt; IO ()
</span><a href="GameState.html#showFirstRoom"><span class="hs-identifier hs-var hs-var">showFirstRoom</span></a></span></span><span> </span><span id="local-6989586621679123153"><span class="annot"><span class="annottext">roomName :: ItemName
</span><a href="#local-6989586621679123153"><span class="hs-identifier hs-var">roomName</span></a></span></span><span> </span><span id="local-6989586621679123152"><span class="annot"><span class="annottext">world :: World
</span><a href="#local-6989586621679123152"><span class="hs-identifier hs-var">world</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Room -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(Room -&gt; IO ()) -&gt; Room -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Room -&gt; ItemName -&gt; World -&gt; Room
forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><span class="hs-identifier hs-var">M.findWithDefault</span></span><span> </span><span class="annot"><span class="annottext">Room
</span><a href="RoomParser.html#lostRoom"><span class="hs-identifier hs-var">lostRoom</span></a></span><span> </span><span class="annot"><span class="annottext">ItemName
</span><a href="#local-6989586621679123153"><span class="hs-identifier hs-var">roomName</span></a></span><span> </span><span class="annot"><span class="annottext">World
</span><a href="#local-6989586621679123152"><span class="hs-identifier hs-var">world</span></a></span><span> </span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Funkcja 'processActionWithMessage' s&#322;u&#380;y do wypisywania podanej wiadomo&#347;ci.</span><span>
</span><span id="line-109"></span><span class="annot"><a href="GameState.html#processActionWithMessage"><span class="hs-identifier hs-type">processActionWithMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GameState.html#GameIO"><span class="hs-identifier hs-type">GameIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span id="processActionWithMessage"><span class="annot"><span class="annottext">processActionWithMessage :: FilePath -&gt; GameIO ()
</span><a href="GameState.html#processActionWithMessage"><span class="hs-identifier hs-var hs-var">processActionWithMessage</span></a></span></span><span> </span><span id="local-6989586621679123149"><span class="annot"><span class="annottext">msg :: FilePath
</span><a href="#local-6989586621679123149"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; GameIO ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; GameIO ()) -&gt; IO () -&gt; GameIO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123149"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- | Funkcja 'acceptAction' s&#322;u&#380;y do wypisywania wiadomo&#347;ci o powodzeniu wykonania akcji. </span><span>
</span><span id="line-113"></span><span class="annot"><a href="GameState.html#acceptAction"><span class="hs-identifier hs-type">acceptAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameState.html#GameIO"><span class="hs-identifier hs-type">GameIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span id="acceptAction"><span class="annot"><span class="annottext">acceptAction :: GameIO ()
</span><a href="GameState.html#acceptAction"><span class="hs-identifier hs-var hs-var">acceptAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; GameIO ()
</span><a href="GameState.html#processActionWithMessage"><span class="hs-identifier hs-var">processActionWithMessage</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Ok.&quot;</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | Funkcja 'rejectAction' s&#322;u&#380;y do wypisywania wiadomo&#347;ci o niepowodzeniu wykonania akcji. </span><span>
</span><span id="line-117"></span><span class="annot"><a href="GameState.html#rejectAction"><span class="hs-identifier hs-type">rejectAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GameState.html#GameIO"><span class="hs-identifier hs-type">GameIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span id="rejectAction"><span class="annot"><span class="annottext">rejectAction :: GameIO ()
</span><a href="GameState.html#rejectAction"><span class="hs-identifier hs-var hs-var">rejectAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; GameIO ()
</span><a href="GameState.html#processActionWithMessage"><span class="hs-identifier hs-var">processActionWithMessage</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;I don't know that.&quot;</span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span></pre></body></html>